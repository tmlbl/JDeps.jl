#!/bin/bash

ARGS="$@"
OS=`uname`

# Get cli.jl location
if [ "$OS" = "Darwin" ]; then
  SCRIPT=`readlink ${0} | awk '{gsub(/jvm/,"cli.jl");}1'`
else
  SCRIPT=`readlink -f ${0} | awk '{gsub(/jvm/,"cli.jl");}1'`
fi

# Move juliarc.jl out of the way temporarily
# TODO: Better way to handle this
JULIA_RC=$HOME/.juliarc.jl

if [[ -e "$JULIA_RC" ]]; then
  mv $JULIA_RC $JULIA_RC.jvm.bak
fi

# Launch JVM package in julia
julia -q --color=yes $SCRIPT $ARGS
xit=$?

if [[ -e "$JULIA_RC.jvm.bak" ]]; then
  mv $JULIA_RC.jvm.bak $JULIA_RC
fi

exit $xit
